<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iheatmapr • iheatmapr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">iheatmapr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/iheatmapr.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="iheatmapr_files/htmlwidgets-0.8/htmlwidgets.js"></script><link href="iheatmapr_files/plotlyjs-1.16.3/plotly-htmlwidgets.css" rel="stylesheet">
<script src="iheatmapr_files/plotlyjs-1.16.3/plotly-latest.min.js"></script><script src="iheatmapr_files/plotly-binding-4.5.6/plotly.js"></script><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>iheatmapr</h1>
                        <h4 class="author">Alicia Schep</h4>
            
            <h4 class="date">2017-03-16</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h1>
<p>iheatmapr is an R package for building complex, interactive heatmaps using modular building blocks. “Complex” heatmaps are heatmaps in which subplots along the rows or columns of the main heatmap add more information about each row or column. For example, a one column additional heatmap may indicate what group a particular row or column belongs to. Complex heatmaps may also include multiple side by side heatmaps which show different types of data for the same conditions. Interactivity can improve complex heatmaps by providing tooltips with information about each cell and enabling zooming into interesting features.</p>
<p>For this vignette, we will use the Indometh data included in the datasets package. This data set contains data on the pharmacokinetics of Indometacin, specifically the observed plasma concentration of indometacin at various time points after intravenous injection for 6 different patients. We will first cast the data into a matrix of concentrations by patients (rows) and time (columns). We will also compute correlation matrices for the patients, and the maximum and minimum concentration of Indometacin per patient. Finally, we will assign patients into some groups – in this dataset no extra patient information is provided and so we’ll just make arbitrary groups that are intended to show how one might use actual groupings like gender or ethnicity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(iheatmapr)
<span class="kw">library</span>(plotly)
<span class="kw">library</span>(datasets)
<span class="kw">library</span>(reshape2)

Indometh_matrix &lt;-<span class="st"> </span><span class="kw">acast</span>(Indometh, Subject <span class="op">~</span><span class="st"> </span>time, <span class="dt">value.var =</span> <span class="st">"conc"</span>)
Indometh_matrix &lt;-<span class="st"> </span>Indometh_matrix[<span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>),]
<span class="kw">rownames</span>(Indometh_matrix) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">"Patient"</span>,<span class="kw">rownames</span>(Indometh_matrix))
Indometh_patient_cor &lt;-<span class="st"> </span><span class="kw">cor</span>(<span class="kw">t</span>(Indometh_matrix))

patient_max_conc &lt;-<span class="st"> </span><span class="kw">apply</span>(Indometh_matrix,<span class="dv">1</span>,max)
patient_min_conc &lt;-<span class="st"> </span><span class="kw">apply</span>(Indometh_matrix,<span class="dv">1</span>,min)
patient_groups &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>) <span class="co"># Arbitrary groups</span></code></pre></div>
<div id="example-complex-heatmap" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#example-complex-heatmap" class="anchor"> </a></body></html>Example Complex Heatmap</h2>
<p>We will start off by showing an example of the type of complex heatmap we can create using the iheatmapr package. In our example complex heatmap, we will plot:</p>
<ul>
<li>a heatmap of the correlation matrix</li>
<li>dendrogram for column clustering</li>
<li>adendrogram for row clustering as well as annotation heatmap showing 3 clusters</li>
<li>annotation heatmaps showing the max and min Indometacin concentrations per patient</li>
<li>annotation heatmap showing whether patients fall in group “A” or “B”</li>
<li>a heatmap showing the actual Indometacin timecourse data for each patient</li>
<li>a plot showing the average Indometacin timecourse response</li>
<li>titles and labels for heatmaps</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor,<span class="dt">name =</span> <span class="st">"Correlation"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_clustering.html">add_col_clustering</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_clustering.html">add_row_clustering</a></span>(<span class="dt">k =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_title.html">add_row_title</a></span>(<span class="st">"Patients"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_title.html">add_col_title</a></span>(<span class="st">"Patients"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                <span class="st">"Groups"</span> =<span class="st"> </span>patient_groups)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_main_heatmap.html">add_main_heatmap</a></span>(Indometh_matrix,
                   <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_labels.html">add_col_labels</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_title.html">add_col_title</a></span>(<span class="st">"Time"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>()</code></pre></div>
<div id="htmlwidget-ba0955bfe93478626437" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba0955bfe93478626437">{"x":{"data":[{"z":[[1,0.965773901965006,0.951013130877337,0.976554671712002,0.964571333758498,0.965923796718617],[0.965773901965006,1,0.945569345888539,0.988184065237917,0.984112317478279,0.974912505080182],[0.951013130877337,0.945569345888539,1,0.980573870131569,0.984220839243537,0.985463149439562],[0.976554671712002,0.988184065237917,0.980573870131569,1,0.994383146538843,0.995838446707506],[0.964571333758498,0.984112317478279,0.984220839243537,0.994383146538843,1,0.992075489712426],[0.965923796718617,0.974912505080182,0.985463149439562,0.995838446707506,0.992075489712426,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617"],["Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182"],["Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562"],["Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506"],["Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426"],["Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: 2"],["Row: Patient 4<br>Column: Groups<br>Value: 2"],["Row: Patient 5<br>Column: Groups<br>Value: 3"],["Row: Patient 6<br>Column: Groups<br>Value: 1"],["Row: Patient 1<br>Column: Groups<br>Value: 1"],["Row: Patient 3<br>Column: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.333333333333333,"#1B9E77"],[0.333333333333333,"#D95F02"],[0.666666666666667,"#D95F02"],[0.666666666666667,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.33333333333333,2,2.66666666666667]}},{"z":[[2.03],[1.85],[2.05],[2.31],[1.5],[2.72]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"],["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"]],"colorscale":[[0,"#F7FCFD"],[0.286885245901639,"#BDE6DD"],[0.434426229508196,"#81CEB7"],[0.450819672131147,"#7BCBB2"],[0.663934426229508,"#38A367"],[1,"#00441B"]],"xaxis":"x5","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.08],[0.07],[0.06],[0.09],[0.05],[0.08]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"],["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"]],"colorscale":[[0,"#FFFFCC"],[0.25,"#FED976"],[0.5,"#FD8D3C"],[0.75,"#E31A1C"],[1,"#800026"]],"xaxis":"x6","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[1],[1],[2]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"],["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"]],"colorscale":[[0,"#A6CEE3"],[0.5,"#A6CEE3"],[0.5,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x7","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09],[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"],["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"]],"colorscale":[[0,"#FFF7FB"],[0.00374531835205992,"#FEF7FB"],[0.00749063670411985,"#FEF6FA"],[0.0112359550561798,"#FDF6FA"],[0.0149812734082397,"#FDF5FA"],[0.0187265917602996,"#FCF5FA"],[0.0224719101123595,"#FCF4F9"],[0.0262172284644195,"#FBF4F9"],[0.0299625468164794,"#FAF3F9"],[0.0411985018726592,"#F9F2F8"],[0.0449438202247191,"#F8F1F8"],[0.0524344569288389,"#F7F0F7"],[0.0561797752808989,"#F6F0F7"],[0.0636704119850187,"#F5EFF6"],[0.0674157303370786,"#F5EEF6"],[0.0711610486891386,"#F4EEF6"],[0.0749063670411985,"#F4EDF6"],[0.0936329588014981,"#F1EBF4"],[0.101123595505618,"#F0EAF4"],[0.116104868913858,"#EDE8F3"],[0.119850187265918,"#EDE8F2"],[0.127340823970037,"#EBE7F2"],[0.131086142322097,"#EBE6F1"],[0.138576779026217,"#E9E5F1"],[0.161048689138577,"#E4E1EF"],[0.202247191011236,"#DBD9EB"],[0.220973782771536,"#D6D6E9"],[0.243445692883895,"#D1D2E7"],[0.247191011235955,"#D1D1E6"],[0.273408239700374,"#C8CDE4"],[0.280898876404494,"#C6CCE3"],[0.284644194756554,"#C5CBE3"],[0.295880149812734,"#C1CAE2"],[0.314606741573034,"#BBC7E0"],[0.333333333333333,"#B4C4DF"],[0.363295880149813,"#AABFDC"],[0.367041198501873,"#A9BEDC"],[0.370786516853933,"#A7BEDB"],[0.415730337078652,"#96B6D7"],[0.50187265917603,"#73A9CF"],[0.52059925093633,"#6BA5CD"],[0.539325842696629,"#63A1CA"],[0.543071161048689,"#62A0CA"],[0.591760299625468,"#4A97C4"],[0.674157303370786,"#2983BA"],[0.741573033707865,"#0C72B1"],[0.749063670411985,"#0670B0"],[0.846441947565543,"#045F95"],[1,"#023858"]],"xaxis":"x8","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.3,"len":0.27,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x8","yaxis":"y6","showlegend":false,"type":"scatter"}],"layout":{"xaxis4":{"domain":[0,0.0393700787401575],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis3":{"domain":[0.0433070866141732,0.102362204724409],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis2":{"domain":[0.104330708661417,0.124015748031496],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.125984251968504,0.519685039370079],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis5":{"domain":[0.525590551181102,0.545275590551181],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis6":{"domain":[0.548228346456693,0.567913385826772],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis7":{"domain":[0.570866141732283,0.590551181102362],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis8":{"domain":[0.606299212598425,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0.140065146579804,0.791530944625407],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.794788273615635,0.892508143322475],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis3":{"domain":[0.0684039087947883,0.133550488599348],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis4":{"domain":[0.0716612377850161,0.136807817589576],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis5":{"domain":[0,0.0651465798045601],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis6":{"domain":[0.804560260586319,1],"anchor":"x8"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":2.6875,"x1":1.5,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.07945134058047,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.07945134058047,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0586007929957255,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.0586007929957255,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.054501156730228,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.0586007929957255,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.018788751846197,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.0146875002644584,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}}],"annotations":[{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x4","yref":"y"},{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"},{"text":"0.25","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.5","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.75","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1.25","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"2","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"3","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"4","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"5","x":9,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"6","x":10,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"8","x":11,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x8","yref":"y5"}],"legend":{"x":1.53,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>All the plots aligned with the correlation heatmap horizontally share the same y axis and thus zooming in the y direction within the heatmap will also zoom in to those subplots. The plots aligned with either the correlation heatmap or the concentration heatmap vertically share an x axis with that heatmap and zooming horizontally within those plots will be linked.</p>
<p>Hovering over the heatmaps yields a tooltip with the name of the row and column as well as the value represented.</p>
</div>
<div id="modular-system-for-building-up-complex-heatmaps" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#modular-system-for-building-up-complex-heatmaps" class="anchor"> </a></body></html>Modular system for building up complex heatmaps</h2>
<p>In our example complex heatmap above, the various components are added iteratively. There are two main types of plots in iheatmapr– “main heatmaps” and subplots. Subplots can be added to the left, right, top, or bottom of a main heatmap. We will go over the basics of adding together different components of a plot in this section, and the <a href="#modular-building-blocks">Modular buidling blocks</a> section of the vignette will go into detail into each of the modular components available.</p>
<div id="starting-with-basic-heatmap" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#starting-with-basic-heatmap" class="anchor"> </a></body></html>Starting with basic heatmap</h3>
<p>To initialize a complex heatmap, we start off by making a very simple heatmap using the <code>main_heatmap</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor, <span class="dt">name =</span> <span class="st">"Correlation"</span>)

example_heatmap</code></pre></div>
<div id="htmlwidget-015d86d82260437f0416" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-015d86d82260437f0416">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="adding-subplots-to-right-or-left" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#adding-subplots-to-right-or-left" class="anchor"> </a></body></html>Adding subplots to right or left</h3>
<p>To this heatmap, we can add subplots to the top, bottom, left, or right. To illustrate how subplots are added we will start with one kind of subplot – annotation heatmaps. The function <code>add_row_annotation</code> adds annotation heatmap(s) to the side of a heatmap. These functions are most easily chained together using the <code>%&gt;%</code> operator from the magrittr package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Groups"</span> =<span class="st"> </span>patient_groups))

example_heatmap</code></pre></div>
<div id="htmlwidget-fef11f1d5d78c87d1af1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-fef11f1d5d78c87d1af1">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.938967136150235],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.953051643192488,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>After adding one subplot to the right of a heatmap, we can easily add another. We can add as many subplots to any side of the heatmap as we want.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Groups"</span> =<span class="st"> </span>patient_groups))

example_heatmap</code></pre></div>
<div id="htmlwidget-b4808742b6f7a9cb12e2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b4808742b6f7a9cb12e2">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.884955752212389],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.898230088495575,0.942477876106195],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.955752212389381,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>We can also add the subplot to the left instead of the right by specifying <code>side = left</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Groups"</span> =<span class="st"> </span>patient_groups), <span class="dt">side =</span> <span class="st">"left"</span>)

example_heatmap</code></pre></div>
<div id="htmlwidget-d3b95e85781984738ca6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d3b95e85781984738ca6">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.0543933054393305,0.891213389121339],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.903765690376569,0.945606694560669],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.9581589958159,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0,0.0418410041841004],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="adding-subplot-to-top-or-bottom" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#adding-subplot-to-top-or-bottom" class="anchor"> </a></body></html>Adding subplot to top or bottom</h3>
<p>The analogous function add_col_annotation can be used for adding annotation heatmap(s) to the top or bottom of a heatmap. We will first add one to the top (default side).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_annotation.html">add_col_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Groups"</span> =<span class="st"> </span>patient_groups))

example_heatmap</code></pre></div>
<div id="htmlwidget-284be496a2425156c202" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-284be496a2425156c202">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.0543933054393305,0.891213389121339],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.903765690376569,0.945606694560669],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.9581589958159,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0,0.0418410041841004],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,0.938967136150235],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.953051643192488,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Now we add one to the bottom:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_annotation.html">add_col_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Groups"</span> =<span class="st"> </span>patient_groups), <span class="dt">side =</span> <span class="st">"bottom"</span>)

example_heatmap</code></pre></div>
<div id="htmlwidget-1043984c18c2c5660fc0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1043984c18c2c5660fc0">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y3","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.0543933054393305,0.891213389121339],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.903765690376569,0.945606694560669],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.9581589958159,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0,0.0418410041841004],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0.0575221238938052,0.942477876106195],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95575221238938,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis3":{"domain":[0,0.0442477876106193],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The axis titles seem to overlap a bit – to avoid this we can potentially alter the spacing between the plots – see <a href="#altering-plot-sizes-and-spacing">Altering plot sizes and spacing</a>.</p>
</div>
<div id="additional-main-heatmaps" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#additional-main-heatmaps" class="anchor"> </a></body></html>Additional main heatmaps</h3>
<p>We can add another “main heatmap” using the <code>add_main_heatmap</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_main_heatmap.html">add_main_heatmap</a></span>(Indometh_patient_cor, <span class="dt">name =</span> <span class="st">"Correlation"</span>)

example_heatmap</code></pre></div>
<div id="htmlwidget-8746428b32a5c045e0da" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8746428b32a5c045e0da">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y3","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x5","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis4":{"domain":[0,0.0223713646532438],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.029082774049217,0.476510067114094],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.483221476510067,0.505592841163311],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.512304250559284,0.534675615212528],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.552572706935123,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0.0575221238938052,0.942477876106195],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95575221238938,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis3":{"domain":[0,0.0442477876106193],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Once we’ve added another main heatmap, when we add a subplot to the top or bottom, by default it will go on top/bottom of the most recently added heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_heatmap &lt;-<span class="st"> </span>example_heatmap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_annotation.html">add_col_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Groups"</span> =<span class="st"> </span>patient_groups))

example_heatmap</code></pre></div>
<div id="htmlwidget-0b612eebe731dd03e264" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0b612eebe731dd03e264">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y3","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x5","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":[1],"type":"heatmap","text":[["Row: Groups<br>Column: Patient 1<br>Value: A","Row: Groups<br>Column: Patient 2<br>Value: A","Row: Groups<br>Column: Patient 3<br>Value: B","Row: Groups<br>Column: Patient 4<br>Value: A","Row: Groups<br>Column: Patient 5<br>Value: B","Row: Groups<br>Column: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x5","yaxis":"y4","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis4":{"domain":[0,0.0223713646532438],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.029082774049217,0.476510067114094],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.483221476510067,0.505592841163311],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.512304250559284,0.534675615212528],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.552572706935123,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0.0575221238938052,0.942477876106195],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95575221238938,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis3":{"domain":[0,0.0442477876106193],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis4":{"domain":[0.95575221238938,1],"anchor":"x5","anchor.1":"x5","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To specify that we want to add the subplot to another main heatmap, the same “xname” argument can be passed both to the desired main heatmap and the subplot to be added.</p>
</div>
<div id="row-and-column-ordering" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#row-and-column-ordering" class="anchor"> </a></body></html>Row and Column ordering</h3>
<p>When we initialize a heatmap using <code>main_heatmap</code> we can specify the row and/ or column order using the <code>row_order</code> and <code>col_order</code> arguments respectively. The functions <code>add_row_clustering</code> or <code>add_col_clustering</code> (See <a href="#add-clustering">Add clustering</a>) can also be used to order the rows or columns. When the row or column order is specified (either initially or through a later function), this ordering is carried through to all plots along the same axis.</p>
</div>
</div>
<div id="the-iheatmap-and-add_iheatmap-functions" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#the-iheatmap-and-add_iheatmap-functions" class="anchor"> </a></body></html>The iheatmap and add_iheatmap functions</h2>
<p>The iheatmapr package includes two functions, <code>iheatmap</code> and <code>add_iheatmap</code>, that wrap together several of the modular building blocks that are often used in conjunction to make common types of heatmaps. Rather than calling many of the modular functions individually, additional arguments can be passed to <code>iheatmap</code> or <code>add_iheatmap</code>. Not all modular subcomponents can be specified this way, but such components can still be added directly through their function calls (e.g. <code>add_col_summary</code>). The following code generates the same plot as our first example heatmap above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/iheatmap.html">iheatmap</a></span>(Indometh_patient_cor, 
         <span class="dt">cluster_cols =</span> <span class="st">"hclust"</span>, 
         <span class="dt">cluster_rows =</span> <span class="st">"hclust"</span>,
         <span class="dt">col_title =</span> <span class="st">"Patients"</span>,
         <span class="dt">row_title =</span> <span class="st">"Patients"</span>,
         <span class="dt">name =</span> <span class="st">"Correlation"</span>,
         <span class="dt">row_k =</span> <span class="dv">3</span>,
         <span class="dt">row_annotation =</span> <span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                     <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                     <span class="st">"Groups"</span> =<span class="st"> </span>patient_groups)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_iheatmap.html">add_iheatmap</a></span>(Indometh_matrix,
               <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span>
               <span class="dt">col_title =</span> <span class="st">"Time"</span>,
               <span class="dt">col_labels =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>()</code></pre></div>
<div id="htmlwidget-13a5ead5809a78e2ab64" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-13a5ead5809a78e2ab64">{"x":{"data":[{"z":[[1,0.965773901965006,0.951013130877337,0.976554671712002,0.964571333758498,0.965923796718617],[0.965773901965006,1,0.945569345888539,0.988184065237917,0.984112317478279,0.974912505080182],[0.951013130877337,0.945569345888539,1,0.980573870131569,0.984220839243537,0.985463149439562],[0.976554671712002,0.988184065237917,0.980573870131569,1,0.994383146538843,0.995838446707506],[0.964571333758498,0.984112317478279,0.984220839243537,0.994383146538843,1,0.992075489712426],[0.965923796718617,0.974912505080182,0.985463149439562,0.995838446707506,0.992075489712426,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617"],["Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182"],["Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562"],["Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506"],["Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426"],["Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: 2"],["Row: Patient 4<br>Column: Groups<br>Value: 2"],["Row: Patient 5<br>Column: Groups<br>Value: 3"],["Row: Patient 6<br>Column: Groups<br>Value: 1"],["Row: Patient 1<br>Column: Groups<br>Value: 1"],["Row: Patient 3<br>Column: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.333333333333333,"#1B9E77"],[0.333333333333333,"#D95F02"],[0.666666666666667,"#D95F02"],[0.666666666666667,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.33333333333333,2,2.66666666666667]}},{"z":[[2.03],[1.85],[2.05],[2.31],[1.5],[2.72]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"],["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"]],"colorscale":[[0,"#F7FCFD"],[0.286885245901639,"#BDE6DD"],[0.434426229508196,"#81CEB7"],[0.450819672131147,"#7BCBB2"],[0.663934426229508,"#38A367"],[1,"#00441B"]],"xaxis":"x4","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.08],[0.07],[0.06],[0.09],[0.05],[0.08]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"],["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"]],"colorscale":[[0,"#FFFFCC"],[0.25,"#FED976"],[0.5,"#FD8D3C"],[0.75,"#E31A1C"],[1,"#800026"]],"xaxis":"x5","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[1],[1],[2]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"],["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"]],"colorscale":[[0,"#A6CEE3"],[0.5,"#A6CEE3"],[0.5,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x6","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.6,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09],[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"],["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"]],"colorscale":[[0,"#FFF7FB"],[0.00374531835205992,"#FEF7FB"],[0.00749063670411985,"#FEF6FA"],[0.0112359550561798,"#FDF6FA"],[0.0149812734082397,"#FDF5FA"],[0.0187265917602996,"#FCF5FA"],[0.0224719101123595,"#FCF4F9"],[0.0262172284644195,"#FBF4F9"],[0.0299625468164794,"#FAF3F9"],[0.0411985018726592,"#F9F2F8"],[0.0449438202247191,"#F8F1F8"],[0.0524344569288389,"#F7F0F7"],[0.0561797752808989,"#F6F0F7"],[0.0636704119850187,"#F5EFF6"],[0.0674157303370786,"#F5EEF6"],[0.0711610486891386,"#F4EEF6"],[0.0749063670411985,"#F4EDF6"],[0.0936329588014981,"#F1EBF4"],[0.101123595505618,"#F0EAF4"],[0.116104868913858,"#EDE8F3"],[0.119850187265918,"#EDE8F2"],[0.127340823970037,"#EBE7F2"],[0.131086142322097,"#EBE6F1"],[0.138576779026217,"#E9E5F1"],[0.161048689138577,"#E4E1EF"],[0.202247191011236,"#DBD9EB"],[0.220973782771536,"#D6D6E9"],[0.243445692883895,"#D1D2E7"],[0.247191011235955,"#D1D1E6"],[0.273408239700374,"#C8CDE4"],[0.280898876404494,"#C6CCE3"],[0.284644194756554,"#C5CBE3"],[0.295880149812734,"#C1CAE2"],[0.314606741573034,"#BBC7E0"],[0.333333333333333,"#B4C4DF"],[0.363295880149813,"#AABFDC"],[0.367041198501873,"#A9BEDC"],[0.370786516853933,"#A7BEDB"],[0.415730337078652,"#96B6D7"],[0.50187265917603,"#73A9CF"],[0.52059925093633,"#6BA5CD"],[0.539325842696629,"#63A1CA"],[0.543071161048689,"#62A0CA"],[0.591760299625468,"#4A97C4"],[0.674157303370786,"#2983BA"],[0.741573033707865,"#0C72B1"],[0.749063670411985,"#0670B0"],[0.846441947565543,"#045F95"],[1,"#023858"]],"xaxis":"x8","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.3,"len":0.27,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x8","yaxis":"y6","showlegend":false,"type":"scatter"}],"layout":{"xaxis7":{"domain":[0,0.037037037037037],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis3":{"domain":[0.0407407407407407,0.0962962962962963],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis2":{"domain":[0.0981481481481481,0.116666666666667],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.118518518518518,0.488888888888889],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis4":{"domain":[0.494444444444445,0.512962962962963],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.515740740740741,0.534259259259259],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis6":{"domain":[0.537037037037037,0.555555555555556],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis8":{"domain":[0.62962962962963,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0.140065146579804,0.791530944625407],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.794788273615635,0.892508143322475],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis3":{"domain":[0.0684039087947883,0.133550488599348],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis4":{"domain":[0.0716612377850161,0.136807817589576],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis5":{"domain":[0,0.0651465798045601],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis6":{"domain":[0.804560260586319,1],"anchor":"x8"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.054501156730228,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.0586007929957255,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.018788751846197,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.0146875002644584,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.07945134058047,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.07945134058047,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0586007929957255,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.0586007929957255,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"annotations":[{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x7","yref":"y"},{"text":"0.25","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.5","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.75","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1.25","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"2","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"3","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"4","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"5","x":9,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"6","x":10,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"8","x":11,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x8","yref":"y5"}],"legend":{"x":1.53,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>These functions can be useful for quickly creating a fairly standard plot. However, fewer options are available with <code>iheatmap</code> than if using each of the modular functions by themselves and there is much less flexibility in the ordering and sizing of the different subcomponents.</p>
</div>
<div id="saving-plots" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#saving-plots" class="anchor"> </a></body></html>Saving plots</h2>
<p>The <code>save_iheatmap</code> function can be used to save an iheatmap object as a standalone html file or as a static pdf/png/jpeg.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myplot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/iheatmap.html">iheatmap</a></span>(Indometh_patient_cor, 
         <span class="dt">cluster_cols =</span> <span class="st">"hclust"</span>, 
         <span class="dt">cluster_rows =</span> <span class="st">"hclust"</span>,
         <span class="dt">col_title =</span> <span class="st">"Patients"</span>,
         <span class="dt">name =</span> <span class="st">"Correlation"</span>) 

myplot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/save_iheatmap.html">save_iheatmap</a></span>(<span class="st">"myplot.html"</span>) <span class="co"># Save interactive HTML</span>
myplot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/save_iheatmap.html">save_iheatmap</a></span>(<span class="st">"myplot.pdf"</span>) <span class="co"># Save static plot (pdf, png, or jpeg)</span></code></pre></div>
</div>
</div>
<div id="modular-building-blocks" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#modular-building-blocks" class="anchor"> </a></body></html>Modular building blocks</h1>
<p>In this section of the vignette, we will explore each of the modular components included in the iheatmapr package.</p>
<div id="main-heatmap" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#main-heatmap" class="anchor"> </a></body></html>Main heatmap</h2>
<p>The <code>main_heatmap</code> function creates a basic heatmap. By default, the column and row names of the input matrix are used for determining the “Row” and “Column” labels in the tooltip above each cell.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor, 
             <span class="dt">name =</span> <span class="st">"Correlation"</span>)</code></pre></div>
<div id="htmlwidget-8d3e34114efe1db73922" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8d3e34114efe1db73922">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Alternatively one can provide the “y” or “x” arguments to use different labels in the tooltip. Providing these arguments will also affect the row and column labels if those are added later (See <a href="#add-labels">Add labels</a>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">patient_names &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Patient "</span>,<span class="kw">seq_len</span>(<span class="kw">ncol</span>(Indometh_patient_cor)))

<span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor, 
             <span class="dt">x =</span> patient_names,
             <span class="dt">y =</span> patient_names,
             <span class="dt">name =</span> <span class="st">"Correlation"</span>)</code></pre></div>
<div id="htmlwidget-ede434419d71501945a7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ede434419d71501945a7">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To change the color use the “colors” argument with either the name of an RColorBrewer palette or a vector of colors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor,
             <span class="dt">colors =</span> <span class="st">"Blues"</span>,
             <span class="dt">name =</span> <span class="st">"Correlation"</span>)</code></pre></div>
<div id="htmlwidget-ed068fda13347e436a70" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed068fda13347e436a70">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#F7FBFF"],[0.100013220080906,"#E3EEF9"],[0.349104529059078,"#A6CEE4"],[0.371198112649773,"#9FCBE1"],[0.373951979125523,"#9ECAE1"],[0.539092532886991,"#5FA5D1"],[0.569262418930555,"#569ECD"],[0.64310313396838,"#3E8DC4"],[0.708111490095512,"#2E7CBB"],[0.710105252012013,"#2D7BBA"],[0.732928975450674,"#2775B7"],[0.782917641631007,"#1C68AE"],[0.854410893697019,"#0E56A0"],[0.896807165872843,"#084B93"],[0.923543941177481,"#094489"],[1,"#08306B"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="add-main-heatmap" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-main-heatmap" class="anchor"> </a></body></html>Add main heatmap</h2>
<p>The <code>add_main_heatmap</code> function is very similar to the main heatmap function, it just adds a new main heatmap to the left or right of the existing plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor, <span class="dt">name =</span> <span class="st">"Correlation"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_main_heatmap.html">add_main_heatmap</a></span>(Indometh_matrix, <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>)</code></pre></div>
<div id="htmlwidget-2e1404baf8892a0e759f" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2e1404baf8892a0e759f">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#F7FCFD"],[0.00374531835205992,"#F6FCFD"],[0.00749063670411985,"#F6FCFD"],[0.0112359550561798,"#F5FBFD"],[0.0149812734082397,"#F5FBFD"],[0.0187265917602996,"#F4FBFC"],[0.0224719101123595,"#F4FBFC"],[0.0262172284644195,"#F3FBFC"],[0.0299625468164794,"#F3FAFC"],[0.0411985018726592,"#F1FAFC"],[0.0449438202247191,"#F1F9FC"],[0.0524344569288389,"#EFF9FB"],[0.0561797752808989,"#EFF9FB"],[0.0636704119850187,"#EEF8FB"],[0.0674157303370786,"#EDF8FB"],[0.0711610486891386,"#EDF8FB"],[0.0749063670411985,"#ECF8FB"],[0.0936329588014981,"#EAF7FA"],[0.101123595505618,"#E8F6FA"],[0.116104868913858,"#E6F5F9"],[0.119850187265918,"#E6F5F9"],[0.127340823970037,"#E5F5F9"],[0.131086142322097,"#E4F5F8"],[0.138576779026217,"#E2F4F7"],[0.161048689138577,"#DEF2F3"],[0.202247191011236,"#D6EFED"],[0.220973782771536,"#D2EEEA"],[0.243445692883895,"#CDECE7"],[0.247191011235955,"#CDECE6"],[0.273408239700374,"#C3E8E1"],[0.280898876404494,"#C0E7DF"],[0.284644194756554,"#BEE6DE"],[0.295880149812734,"#BAE5DB"],[0.314606741573034,"#B2E2D7"],[0.333333333333333,"#AADFD3"],[0.363295880149813,"#9EDACC"],[0.367041198501873,"#9CD9CB"],[0.370786516853933,"#9BD9CA"],[0.415730337078652,"#89D1BD"],[0.50187265917603,"#65C2A3"],[0.52059925093633,"#60BF9C"],[0.539325842696629,"#5BBC95"],[0.543071161048689,"#5ABB94"],[0.591760299625468,"#4CB382"],[0.674157303370786,"#36A063"],[0.741573033707865,"#258D48"],[0.749063670411985,"#238B45"],[0.846441947565543,"#0A7432"],[1,"#00441B"]],"xaxis":"x2","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis":{"domain":[0,0.490196078431373],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.509803921568627,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Note that if the same “name” argument is given to both the first main heatmap and the additional main heatmap, the two heatmaps will share the same colorscale and colorbar.</p>
<p>See <a href="#orientation">Orientation</a> for adding main heataps vertically instead of horizontally!</p>
</div>
<div id="add-labels" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-labels" class="anchor"> </a></body></html>Add labels</h2>
<p>Row and column labels are not shown by default. To add them, use the <code>add_row_labels</code> or <code>add_col_labels</code>. By default, these will use the row and column names provided to the <code>main_heatmap</code> or <code>add_main_heatmap</code> either directly or indirectly via the row and column names of the matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix, <span class="dt">name =</span> <span class="st">"Correlation"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_labels.html">add_row_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_labels.html">add_col_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_title.html">add_row_title</a></span>(<span class="st">"Patients"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_title.html">add_col_title</a></span>(<span class="st">"Patients"</span>)</code></pre></div>
<div id="htmlwidget-98be867f03f573fb8b5c" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-98be867f03f573fb8b5c">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis2":{"domain":[0.0905349794238683,0.17283950617284],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis":{"domain":[0.176954732510288,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis3":{"domain":[0,0.0823045267489712],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.176954732510288,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.0905349794238684,0.17283950617284],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0,0.0823045267489713],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"Patient 1","y":1,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 2","y":2,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 3","y":3,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 4","y":4,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 5","y":5,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 6","y":6,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"0.25","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"0.5","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"0.75","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"1","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"1.25","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"2","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"3","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"4","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"5","x":9,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"6","x":10,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"8","x":11,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x3","yref":"y"},{"text":"Patients","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="add-clustering" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-clustering" class="anchor"> </a></body></html>Add clustering</h2>
<p>The functions <code>add_row_clustering</code> and <code>add_col_clustering</code> will cluster the rows or columns. By default, the clustering is via hierarchical clustering and a dendrogram is added.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_clustering.html">add_row_clustering</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_clustering.html">add_col_clustering</a></span>()</code></pre></div>
<div id="htmlwidget-8013f8a6fc89c290c7a3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8013f8a6fc89c290c7a3">{"x":{"data":[{"z":[[1,0.965773901965006,0.951013130877337,0.976554671712002,0.964571333758498,0.965923796718617],[0.965773901965006,1,0.945569345888539,0.988184065237917,0.984112317478279,0.974912505080182],[0.951013130877337,0.945569345888539,1,0.980573870131569,0.984220839243537,0.985463149439562],[0.976554671712002,0.988184065237917,0.980573870131569,1,0.994383146538843,0.995838446707506],[0.964571333758498,0.984112317478279,0.984220839243537,0.994383146538843,1,0.992075489712426],[0.965923796718617,0.974912505080182,0.985463149439562,0.995838446707506,0.992075489712426,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617"],["Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182"],["Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562"],["Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506"],["Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426"],["Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis":{"domain":[0.134199134199134,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0,0.12987012987013],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.865800865800866],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.87012987012987,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.054501156730228,"y0":1.5,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.0586007929957255,"y0":3.875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.018788751846197,"y0":4.75,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.0146875002644584,"y0":5.5,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.07945134058047,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.07945134058047,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0586007929957255,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.0586007929957255,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Specifying a value of k will result in cluster assignments being made based on the dendrogram and an annotation heatmap gets added showing the clustering.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_clustering.html">add_row_clustering</a></span>(<span class="dt">k =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_clustering.html">add_col_clustering</a></span>()</code></pre></div>
<div id="htmlwidget-615cd8742df7b606a0d3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-615cd8742df7b606a0d3">{"x":{"data":[{"z":[[1,0.965773901965006,0.951013130877337,0.976554671712002,0.964571333758498,0.965923796718617],[0.965773901965006,1,0.945569345888539,0.988184065237917,0.984112317478279,0.974912505080182],[0.951013130877337,0.945569345888539,1,0.980573870131569,0.984220839243537,0.985463149439562],[0.976554671712002,0.988184065237917,0.980573870131569,1,0.994383146538843,0.995838446707506],[0.964571333758498,0.984112317478279,0.984220839243537,0.994383146538843,1,0.992075489712426],[0.965923796718617,0.974912505080182,0.985463149439562,0.995838446707506,0.992075489712426,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617"],["Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182"],["Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562"],["Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506"],["Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426"],["Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: 2"],["Row: Patient 4<br>Column: Groups<br>Value: 2"],["Row: Patient 5<br>Column: Groups<br>Value: 3"],["Row: Patient 6<br>Column: Groups<br>Value: 1"],["Row: Patient 1<br>Column: Groups<br>Value: 1"],["Row: Patient 3<br>Column: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.333333333333333,"#1B9E77"],[0.333333333333333,"#D95F02"],[0.666666666666667,"#D95F02"],[0.666666666666667,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.33333333333333,2,2.66666666666667]}}],"layout":{"xaxis2":{"domain":[0.128099173553719,0.169421487603306],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.173553719008264,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis3":{"domain":[0,0.12396694214876],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.865800865800866],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.87012987012987,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.054501156730228,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.0586007929957255,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.018788751846197,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.0146875002644584,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.07945134058047,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.07945134058047,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0586007929957255,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.0586007929957255,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Alternatively, clustering can be done using kmeans by setting <code>method = "kmeans"</code>. In that case, a value of k must be given!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_clustering.html">add_row_clustering</a></span>(<span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">method =</span> <span class="st">"kmeans"</span>) </code></pre></div>
<div id="htmlwidget-a4b5de482c1c96d9ebac" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a4b5de482c1c96d9ebac">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"z":[[1],[1],[2],[2],[3],[3]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: 1"],["Row: Patient 5<br>Column: Groups<br>Value: 1"],["Row: Patient 2<br>Column: Groups<br>Value: 2"],["Row: Patient 4<br>Column: Groups<br>Value: 2"],["Row: Patient 3<br>Column: Groups<br>Value: 3"],["Row: Patient 6<br>Column: Groups<br>Value: 3"]],"colorscale":[[0,"#1B9E77"],[0.333333333333333,"#1B9E77"],[0.333333333333333,"#D95F02"],[0.666666666666667,"#D95F02"],[0.666666666666667,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.33333333333333,2,2.66666666666667]}}],"layout":{"xaxis":{"domain":[0.0521327014218009,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.04739336492891],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Another way of clustering the results is by giving group assignments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_clustering.html">add_row_clustering</a></span>(<span class="dt">method =</span> <span class="st">"groups"</span>, <span class="dt">groups =</span> <span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>)) </code></pre></div>
<div id="htmlwidget-59026eb9698d280baf83" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-59026eb9698d280baf83">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"z":[[1],[1],[1],[1],[2],[2]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: A"],["Row: Patient 6<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: B"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.0521327014218009,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.04739336492891],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div id="add-row-dendrogram" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#add-row-dendrogram" class="anchor"> </a></body></html>Add row dendrogram</h3>
<p>If you want to perform the hierarchical clustering yourself, you can use the <code>add_row_dendro</code> or <code>add_col_dendro</code> functions to add the dendrogram. The clustering result should be provided as an “hclust” object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clust_res &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>Indometh_patient_cor))

<span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_dendro.html">add_row_dendro</a></span>(clust_res) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_dendro.html">add_col_dendro</a></span>(clust_res)</code></pre></div>
<div id="htmlwidget-f2d710c31422cf8fbb59" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f2d710c31422cf8fbb59">{"x":{"data":[{"z":[[1,0.984220839243537,0.985463149439562,0.980573870131569,0.951013130877337,0.945569345888539],[0.984220839243537,1,0.992075489712426,0.994383146538843,0.964571333758498,0.984112317478279],[0.985463149439562,0.992075489712426,1,0.995838446707506,0.965923796718617,0.974912505080182],[0.980573870131569,0.994383146538843,0.995838446707506,1,0.976554671712002,0.988184065237917],[0.951013130877337,0.964571333758498,0.965923796718617,0.976554671712002,1,0.965773901965006],[0.945569345888539,0.984112317478279,0.974912505080182,0.988184065237917,0.965773901965006,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539"],["Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279"],["Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182"],["Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917"],["Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006"],["Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.946,1]}}],"layout":{"xaxis":{"domain":[0.134199134199134,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0,0.12987012987013],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.865800865800866],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.87012987012987,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.0544306541114605,"x1":-0.0544306541114605,"y0":3.6875,"y1":1.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0544306541114605,"x1":-0.0194261298684314,"y0":1.875,"y1":1.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0194261298684314,"x1":-0.0194261298684314,"y0":1.875,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0194261298684314,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0194261298684314,"x1":-0.0194261298684314,"y0":1.875,"y1":2.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0194261298684314,"x1":-0.00792451028757424,"y0":2.75,"y1":2.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00792451028757424,"x1":-0.00792451028757424,"y0":2.75,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00792451028757424,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00792451028757424,"x1":-0.00792451028757424,"y0":2.75,"y1":3.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00792451028757424,"x1":-0.00416155329249401,"y0":3.5,"y1":3.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00416155329249401,"x1":-0.00416155329249401,"y0":3.5,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00416155329249401,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00416155329249401,"x1":-0.00416155329249401,"y0":3.5,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.00416155329249401,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0544306541114605,"x1":-0.0544306541114605,"y0":3.6875,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0544306541114605,"x1":-0.0342260980349938,"y0":5.5,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0342260980349938,"x1":-0.0342260980349938,"y0":5.5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0342260980349938,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0342260980349938,"x1":-0.0342260980349938,"y0":5.5,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0342260980349938,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":3.6875,"x1":1.875,"y0":0.0544306541114605,"y1":0.0544306541114605,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.875,"x1":1.875,"y0":0.0544306541114605,"y1":0.0194261298684314,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.875,"x1":1,"y0":0.0194261298684314,"y1":0.0194261298684314,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.0194261298684314,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.875,"x1":2.75,"y0":0.0194261298684314,"y1":0.0194261298684314,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.75,"x1":2.75,"y0":0.0194261298684314,"y1":0.00792451028757424,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.75,"x1":2,"y0":0.00792451028757424,"y1":0.00792451028757424,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.00792451028757424,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.75,"x1":3.5,"y0":0.00792451028757424,"y1":0.00792451028757424,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.5,"x1":3.5,"y0":0.00792451028757424,"y1":0.00416155329249401,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.5,"x1":3,"y0":0.00416155329249401,"y1":0.00416155329249401,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.00416155329249401,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.5,"x1":4,"y0":0.00416155329249401,"y1":0.00416155329249401,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.00416155329249401,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.6875,"x1":5.5,"y0":0.0544306541114605,"y1":0.0544306541114605,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.0544306541114605,"y1":0.0342260980349938,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0342260980349938,"y1":0.0342260980349938,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0342260980349938,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0342260980349938,"y1":0.0342260980349938,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0342260980349938,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>If you want to add a dendrogram but have already ordered your matrix, you can set the “reorder” argument to <code>FALSE</code>.</p>
</div>
</div>
<div id="add-annotations" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-annotations" class="anchor"> </a></body></html>Add annotations</h2>
<p>The functions <code>add_row_annotation</code> and <code>add_col_annotation</code> add one or more annotation heatmaps. Annotations should be provided as a data.frame or something that can be coerced into a data.frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>)))</code></pre></div>
<div id="htmlwidget-fb685ca724aedbd6e13c" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-fb685ca724aedbd6e13c">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1.5],[2.03],[2.72],[1.85],[2.05],[2.31]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"]],"colorscale":[[0,"#F7FCFD"],[0.286885245901639,"#BDE6DD"],[0.434426229508196,"#81CEB7"],[0.450819672131147,"#7BCBB2"],[0.663934426229508,"#38A367"],[1,"#00441B"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.05],[0.08],[0.08],[0.07],[0.06],[0.09]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"]],"colorscale":[[0,"#FFFFCC"],[0.25,"#FED976"],[0.5,"#FD8D3C"],[0.75,"#E31A1C"],[1,"#800026"]],"xaxis":"x3","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: B"],["Row: Patient 5<br>Column: Groups<br>Value: A"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.847457627118644],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.860169491525424,0.902542372881356],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.908898305084746,0.951271186440678],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.957627118644068,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.37,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>By default, colors will be chosen for each annotation. To assign colors yourself, provide a list of colors, with the names of the list matching the column names of the annotation. Colors can either be the name of an RColorBrewer palette or a vector of colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>)),
                     <span class="dt">colors =</span> <span class="kw">list</span>(<span class="st">"Max"</span> =<span class="st"> "Reds"</span>,
                                   <span class="st">"Min"</span> =<span class="st"> "Blues"</span>,
                                   <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"purple"</span>,<span class="st">"pink"</span>)))</code></pre></div>
<div id="htmlwidget-94e558c2bbdaf91cf8a5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-94e558c2bbdaf91cf8a5">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1.5],[2.03],[2.72],[1.85],[2.05],[2.31]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.286885245901639,"#FDAF93"],[0.434426229508196,"#FC805F"],[0.450819672131147,"#FC7A5A"],[0.663934426229508,"#E43127"],[1,"#67000D"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.05],[0.08],[0.08],[0.07],[0.06],[0.09]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"]],"colorscale":[[0,"#F7FBFF"],[0.25,"#C6DBEF"],[0.5,"#6BAED6"],[0.75,"#2171B5"],[1,"#08306B"]],"xaxis":"x3","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: B"],["Row: Patient 5<br>Column: Groups<br>Value: A"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"purple"],[0.5,"purple"],[0.5,"pink"],[1,"pink"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.847457627118644],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.860169491525424,0.902542372881356],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.908898305084746,0.951271186440678],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.957627118644068,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.37,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>For more control over annotation heatmaps, use the functions <code>add_col_signal</code> and <code>add_row_signal</code> for adding a single continuous annotation or <code>add_col_groups</code> and <code>add_row_groups</code> for adding a single discrete annotation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_signal.html">add_row_signal</a></span>(patient_max_conc, <span class="st">"Max&lt;br&gt;Concentration"</span>, <span class="dt">title =</span> <span class="st">"Max"</span>, <span class="dt">colors =</span> <span class="st">"Reds"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_signal.html">add_row_signal</a></span>(patient_min_conc, <span class="st">"Min&lt;br&gt;Concentration"</span>, <span class="dt">title =</span> <span class="st">"Min"</span>, <span class="dt">colors =</span> <span class="st">"Reds"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_groups.html">add_row_groups</a></span>(<span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>), <span class="st">"Groups"</span>) </code></pre></div>
<div id="htmlwidget-0e794b9c1fa1b69c08aa" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0e794b9c1fa1b69c08aa">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1.5],[2.03],[2.72],[1.85],[2.05],[2.31]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.286885245901639,"#FDAF93"],[0.434426229508196,"#FC805F"],[0.450819672131147,"#FC7A5A"],[0.663934426229508,"#E43127"],[1,"#67000D"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Max<br>Concentration","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.05],[0.08],[0.08],[0.07],[0.06],[0.09]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"]],"colorscale":[[0,"#FFF5F0"],[0.25,"#FCBBA1"],[0.5,"#FB6A4A"],[0.75,"#CB181D"],[1,"#67000D"]],"xaxis":"x3","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Min<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: B"],["Row: Patient 5<br>Column: Groups<br>Value: A"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.843881856540084],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.856540084388186,0.89873417721519],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.911392405063291,0.953586497890295],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.957805907172996,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.37,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="add-summary" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-summary" class="anchor"> </a></body></html>Add summary</h2>
<p>One type of subplot that can be added is a summary of the values over the rows or the columns. For example when plotting Indometh concentrations per patient over time we might want to plot the average time response using <code>add_col_summary</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>() </code></pre></div>
<div id="htmlwidget-a77384ade1bb666e2573" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a77384ade1bb666e2573">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.757575757575758],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.772727272727273,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p><code>add_row_summary</code> is similar but adds plot along left summarizing rows.</p>
<p>With <code>add_col_summary</code> or <code>add_row_summary</code> we can pass groups to divide by the rows or columns respectively when computing the summary:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>(<span class="dt">groups =</span> <span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>)) </code></pre></div>
<div id="htmlwidget-9412be8ca222eea68739" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9412be8ca222eea68739">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"#1B9E77"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1.9725,1.2625,0.8325,0.6025,0.4875,0.3,0.2025,0.1475,0.135,0.0975,0.07],"text":["A<br>Column: 0.25<br>Value: 1.9725","A<br>Column: 0.5<br>Value: 1.2625","A<br>Column: 0.75<br>Value: 0.8325","A<br>Column: 1<br>Value: 0.6025","A<br>Column: 1.25<br>Value: 0.4875","A<br>Column: 2<br>Value: 0.3","A<br>Column: 3<br>Value: 0.2025","A<br>Column: 4<br>Value: 0.1475","A<br>Column: 5<br>Value: 0.135","A<br>Column: 6<br>Value: 0.0975","A<br>Column: 8<br>Value: 0.07"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"A"},{"line":{"color":"#7570B3"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.285,1.44,1.09,0.845,0.695,0.395,0.19,0.115,0.105,0.075,0.075],"text":["B<br>Column: 0.25<br>Value: 2.285","B<br>Column: 0.5<br>Value: 1.44","B<br>Column: 0.75<br>Value: 1.09","B<br>Column: 1<br>Value: 0.845","B<br>Column: 1.25<br>Value: 0.695","B<br>Column: 2<br>Value: 0.395","B<br>Column: 3<br>Value: 0.19","B<br>Column: 4<br>Value: 0.115","B<br>Column: 5<br>Value: 0.105","B<br>Column: 6<br>Value: 0.075","B<br>Column: 8<br>Value: 0.075"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"B"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.757575757575758],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.772727272727273,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>If groups is set to <code>TRUE</code> rather than a vector of groups, then the function will try to use an existing set of groups or clusters that have been added to the plot. This should be avoided if more than one set of groups has been added (only one of the existing sets of groups will be used in that case.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_clustering.html">add_row_clustering</a></span>(<span class="dt">k =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>(<span class="dt">groups =</span> <span class="ot">TRUE</span>) </code></pre></div>
<div id="htmlwidget-fb1b11c7a842eb26a433" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-fb1b11c7a842eb26a433">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"z":[[1],[1],[3],[3],[2],[2]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: 1"],["Row: Patient 5<br>Column: Groups<br>Value: 1"],["Row: Patient 3<br>Column: Groups<br>Value: 3"],["Row: Patient 6<br>Column: Groups<br>Value: 3"],["Row: Patient 2<br>Column: Groups<br>Value: 2"],["Row: Patient 4<br>Column: Groups<br>Value: 2"]],"colorscale":[[0,"#1B9E77"],[0.333333333333333,"#1B9E77"],[0.333333333333333,"#D95F02"],[0.666666666666667,"#D95F02"],[0.666666666666667,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.33333333333333,2,2.66666666666667]}},{"line":{"color":"#1B9E77"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1.775,0.99,0.795,0.435,0.335,0.21,0.125,0.11,0.08,0.085,0.055],"text":["1<br>Column: 0.25<br>Value: 1.775","1<br>Column: 0.5<br>Value: 0.99","1<br>Column: 0.75<br>Value: 0.795","1<br>Column: 1<br>Value: 0.435","1<br>Column: 1.25<br>Value: 0.335","1<br>Column: 2<br>Value: 0.21","1<br>Column: 3<br>Value: 0.125","1<br>Column: 4<br>Value: 0.11","1<br>Column: 5<br>Value: 0.08","1<br>Column: 6<br>Value: 0.085","1<br>Column: 8<br>Value: 0.055"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"1"},{"line":{"color":"#D95F02"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1.94,1.51,0.865,0.795,0.615,0.38,0.24,0.155,0.175,0.095,0.075],"text":["2<br>Column: 0.25<br>Value: 1.94","2<br>Column: 0.5<br>Value: 1.51","2<br>Column: 0.75<br>Value: 0.865","2<br>Column: 1<br>Value: 0.795","2<br>Column: 1.25<br>Value: 0.615","2<br>Column: 2<br>Value: 0.38","2<br>Column: 3<br>Value: 0.24","2<br>Column: 4<br>Value: 0.155","2<br>Column: 5<br>Value: 0.175","2<br>Column: 6<br>Value: 0.095","2<br>Column: 8<br>Value: 0.075"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"2"},{"line":{"color":"#7570B3"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.515,1.465,1.095,0.82,0.72,0.405,0.23,0.145,0.12,0.09,0.085],"text":["3<br>Column: 0.25<br>Value: 2.515","3<br>Column: 0.5<br>Value: 1.465","3<br>Column: 0.75<br>Value: 1.095","3<br>Column: 1<br>Value: 0.82","3<br>Column: 1.25<br>Value: 0.72","3<br>Column: 2<br>Value: 0.405","3<br>Column: 3<br>Value: 0.23","3<br>Column: 4<br>Value: 0.145","3<br>Column: 5<br>Value: 0.12","3<br>Column: 6<br>Value: 0.09","3<br>Column: 8<br>Value: 0.085"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"3"}],"layout":{"xaxis2":{"domain":[0.128099173553719,0.169421487603306],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.173553719008264,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis3":{"domain":[0,0.12396694214876],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.757575757575758],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.772727272727273,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-1.50817770836198,"x1":-1.50817770836198,"y0":3,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.50817770836198,"x1":-0.573672380370539,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.573672380370539,"x1":-0.573672380370539,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.573672380370539,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.573672380370539,"x1":-0.573672380370539,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.573672380370539,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.50817770836198,"x1":-1.50817770836198,"y0":3,"y1":4.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.50817770836198,"x1":-0.91804139340228,"y0":4.5,"y1":4.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228,"x1":-0.91804139340228,"y0":4.5,"y1":3.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228,"x1":-0.468401537145215,"y0":3.5,"y1":3.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.468401537145215,"x1":-0.468401537145215,"y0":3.5,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.468401537145215,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.468401537145215,"x1":-0.468401537145215,"y0":3.5,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.468401537145215,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228,"x1":-0.91804139340228,"y0":4.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228,"x1":-0.5339475629685,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.5339475629685,"x1":-0.5339475629685,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.5339475629685,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.5339475629685,"x1":-0.5339475629685,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.5339475629685,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="add-barplot" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-barplot" class="anchor"> </a></body></html>Add barplot</h2>
<p>The functions <code>add_col_barplot</code> and <code>add_row_barplot</code> add barplots along the columns or rows of a main heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_barplot.html">add_col_barplot</a></span>(<span class="dt">y =</span> <span class="kw">as.numeric</span>(<span class="kw">colnames</span>(Indometh_matrix)),
                  <span class="dt">tracename =</span> <span class="st">"time"</span>, 
                  <span class="dt">layout =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">"Time"</span>))</code></pre></div>
<div id="htmlwidget-bed8dacd06cbe2996eeb" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-bed8dacd06cbe2996eeb">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"orientation":"v","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"text":["time<br>Column: 0.25<br>Value: 0.25","time<br>Column: 0.5<br>Value: 0.5","time<br>Column: 0.75<br>Value: 0.75","time<br>Column: 1<br>Value: 1","time<br>Column: 1.25<br>Value: 1.25","time<br>Column: 2<br>Value: 2","time<br>Column: 3<br>Value: 3","time<br>Column: 4<br>Value: 4","time<br>Column: 5<br>Value: 5","time<br>Column: 6<br>Value: 6","time<br>Column: 8<br>Value: 8"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":true,"type":"bar","name":"time"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.819672131147541],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.836065573770492,1],"anchor":"x","title":"Time"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="add-line-plot" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-line-plot" class="anchor"> </a></body></html>Add line plot</h2>
<p>The functions <code>add_col_barplot</code> and <code>add_row_barplot</code> add a line plot along the columns or rows of a main heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_plot.html">add_col_plot</a></span>(<span class="dt">y =</span> <span class="kw">as.numeric</span>(<span class="kw">colnames</span>(Indometh_matrix)),
                  <span class="dt">tracename =</span> <span class="st">"time"</span>, 
                  <span class="dt">layout =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">"Time"</span>))</code></pre></div>
<div id="htmlwidget-9d6fe5c4208921828b3d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9d6fe5c4208921828b3d">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"text":["time<br>Column: 0.25<br>Value: 0.25","time<br>Column: 0.5<br>Value: 0.5","time<br>Column: 0.75<br>Value: 0.75","time<br>Column: 1<br>Value: 1","time<br>Column: 1.25<br>Value: 1.25","time<br>Column: 2<br>Value: 2","time<br>Column: 3<br>Value: 3","time<br>Column: 4<br>Value: 4","time<br>Column: 5<br>Value: 5","time<br>Column: 6<br>Value: 6","time<br>Column: 8<br>Value: 8"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":true,"type":"scatter","name":"time"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.819672131147541],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.836065573770492,1],"anchor":"x","title":"Time"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="add-arbitrary-plot" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#add-arbitrary-plot" class="anchor"> </a></body></html>Add arbitrary plot</h2>
<p>The functions for adding barplots or lineplots assume one data point per row or column. To add an arbitrary plot, one can use <code>add_subplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_subplot.html">add_subplot</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">side =</span> <span class="st">"top"</span>)</code></pre></div>
<div id="htmlwidget-cdf26883fb5a7438145e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cdf26883fb5a7438145e">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"x":[1,2,3],"y":[4,5,6],"xaxis":"x","yaxis":"y2"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.476190476190476],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.523809523809524,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="customization-options" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#customization-options" class="anchor"> </a></body></html>Customization options</h1>
<p>The next section of this vignette will cover some customization options available in iheatmapr.</p>
<div id="color-selection" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#color-selection" class="anchor"> </a></body></html>Color selection</h2>
<p>iheatmapr tries to choose colors automatically in a sensible way. If a heatmap with the same “name” argument as another heatmap is added, the two heatmaps will share the same colorbar and scale. Functions to make and add heatmaps and subplots have a “colors” argument that can be used to specify colors manually. These arguments take in RColorBrewer palette names or vectors of colors.</p>
<p>For example, if we simply repeat the same exact main heatmap with the same “name” argument and the same column names for the annotation matrices, the colorbars are not duplicated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_patient_cor, <span class="dt">name =</span> <span class="st">"Correlation"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>)),
                     <span class="dt">colors =</span> <span class="kw">list</span>(<span class="st">"Max"</span> =<span class="st"> "Reds"</span>,
                                   <span class="st">"Min"</span> =<span class="st"> "Blues"</span>,
                                   <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"purple"</span>,<span class="st">"pink"</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/add_main_heatmap.html">add_main_heatmap</a></span>(Indometh_patient_cor, <span class="dt">name =</span> <span class="st">"Correlation"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_row_annotation.html">add_row_annotation</a></span>(<span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>)),
                     <span class="dt">colors =</span> <span class="kw">list</span>(<span class="st">"Max"</span> =<span class="st"> "Reds"</span>,
                                   <span class="st">"Min"</span> =<span class="st"> "Blues"</span>,
                                   <span class="st">"Groups"</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">"purple"</span>,<span class="st">"pink"</span>)))</code></pre></div>
<div id="htmlwidget-20bdf4ab778954a073e3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-20bdf4ab778954a073e3">{"x":{"data":[{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1.5],[2.03],[2.72],[1.85],[2.05],[2.31]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.286885245901639,"#FDAF93"],[0.434426229508196,"#FC805F"],[0.450819672131147,"#FC7A5A"],[0.663934426229508,"#E43127"],[1,"#67000D"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.05],[0.08],[0.08],[0.07],[0.06],[0.09]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"]],"colorscale":[[0,"#F7FBFF"],[0.25,"#C6DBEF"],[0.5,"#6BAED6"],[0.75,"#2171B5"],[1,"#08306B"]],"xaxis":"x3","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: B"],["Row: Patient 5<br>Column: Groups<br>Value: A"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"purple"],[0.5,"purple"],[0.5,"pink"],[1,"pink"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,0.964571333758498,0.992075489712426,0.984112317478279,0.984220839243537,0.994383146538843],[0.964571333758498,1,0.965923796718617,0.965773901965006,0.951013130877337,0.976554671712002],[0.992075489712426,0.965923796718617,1,0.974912505080182,0.985463149439562,0.995838446707506],[0.984112317478279,0.965773901965006,0.974912505080182,1,0.945569345888539,0.988184065237917],[0.984220839243537,0.951013130877337,0.985463149439562,0.945569345888539,1,0.980573870131569],[0.994383146538843,0.976554671712002,0.995838446707506,0.988184065237917,0.980573870131569,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843"],["Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002"],["Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 3<br>Value: 1","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506"],["Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917"],["Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569"],["Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x5","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[1.5],[2.03],[2.72],[1.85],[2.05],[2.31]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.286885245901639,"#FDAF93"],[0.434426229508196,"#FC805F"],[0.450819672131147,"#FC7A5A"],[0.663934426229508,"#E43127"],[1,"#67000D"]],"xaxis":"x6","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.05],[0.08],[0.08],[0.07],[0.06],[0.09]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"]],"colorscale":[[0,"#F7FBFF"],[0.25,"#C6DBEF"],[0.5,"#6BAED6"],[0.75,"#2171B5"],[1,"#08306B"]],"xaxis":"x7","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.3,"len":0.27,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"],["Row: Patient 4<br>Column: Groups<br>Value: B"],["Row: Patient 5<br>Column: Groups<br>Value: A"],["Row: Patient 6<br>Column: Groups<br>Value: A"]],"colorscale":[[0,"purple"],[0.5,"purple"],[0.5,"pink"],[1,"pink"]],"xaxis":"x8","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.9,"len":0.27,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.416666666666667],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.422916666666667,0.44375],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.446875,0.467708333333333],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.470833333333333,0.491666666666667],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.508333333333333,0.925],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis6":{"domain":[0.93125,0.952083333333334],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis7":{"domain":[0.955208333333333,0.976041666666667],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis8":{"domain":[0.979166666666667,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.37,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="colorbars" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#colorbars" class="anchor"> </a></body></html>Colorbars</h2>
<p>When additional heatmaps or annotations with colorscales are added to an iheatmap object, the colorbars will be added according a grid pattern. The layout and spacing of that grid can be specified using the “colorbar_grid” parameter to iheatmap or simple_heatmap. By default, the grid has three rows. To change the layout of the grid to only have 2 rows and adjust the spacing and sizing of the colorbars, we can use the function setup_colorbar_grid to create a ColorbarGridParameters object that can be passed to the colorbar_grid argument to simple_heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid_params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setup_colorbar_grid.html">setup_colorbar_grid</a></span>(<span class="dt">nrows =</span> <span class="dv">2</span>, 
                                   <span class="dt">y_length =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">x_spacing =</span> <span class="fl">0.2</span>,
                                   <span class="dt">y_spacing =</span> <span class="fl">0.5</span>, 
                                   <span class="dt">x_start =</span> <span class="fl">1.1</span>, 
                                   <span class="dt">y_start =</span> <span class="dv">1</span>)


<span class="kw"><a href="../reference/iheatmap.html">iheatmap</a></span>(Indometh_patient_cor, 
         <span class="dt">cluster_cols =</span> <span class="st">"hclust"</span>, 
         <span class="dt">cluster_rows =</span> <span class="st">"hclust"</span>,
         <span class="dt">col_title =</span> <span class="st">"Patients"</span>,
         <span class="dt">name =</span> <span class="st">"Correlation"</span>,
         <span class="dt">row_k =</span> <span class="dv">3</span>,
         <span class="dt">row_annotation =</span> <span class="kw">data.frame</span>(<span class="st">"Max"</span> =<span class="st"> </span>patient_max_conc,
                                     <span class="st">"Min"</span> =<span class="st"> </span>patient_min_conc,
                                     <span class="st">"Groups"</span> =<span class="st"> </span>patient_groups),
         <span class="dt">colorbar_grid =</span> grid_params) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_iheatmap.html">add_iheatmap</a></span>(Indometh_matrix,
               <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span>
               <span class="dt">col_title =</span> <span class="st">"Time"</span>,
         <span class="dt">row_title =</span> <span class="st">"Patients"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>()</code></pre></div>
<div id="htmlwidget-c82348b471adb311f53e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c82348b471adb311f53e">{"x":{"data":[{"z":[[1,0.965773901965006,0.951013130877337,0.976554671712002,0.964571333758498,0.965923796718617],[0.965773901965006,1,0.945569345888539,0.988184065237917,0.984112317478279,0.974912505080182],[0.951013130877337,0.945569345888539,1,0.980573870131569,0.984220839243537,0.985463149439562],[0.976554671712002,0.988184065237917,0.980573870131569,1,0.994383146538843,0.995838446707506],[0.964571333758498,0.984112317478279,0.984220839243537,0.994383146538843,1,0.992075489712426],[0.965923796718617,0.974912505080182,0.985463149439562,0.995838446707506,0.992075489712426,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617"],["Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182"],["Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562"],["Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506"],["Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426"],["Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.1,"y":1,"len":0.3,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: 2"],["Row: Patient 4<br>Column: Groups<br>Value: 2"],["Row: Patient 5<br>Column: Groups<br>Value: 3"],["Row: Patient 6<br>Column: Groups<br>Value: 1"],["Row: Patient 1<br>Column: Groups<br>Value: 1"],["Row: Patient 3<br>Column: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.333333333333333,"#1B9E77"],[0.333333333333333,"#D95F02"],[0.666666666666667,"#D95F02"],[0.666666666666667,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.1,"y":0.5,"len":0.3,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.33333333333333,2,2.66666666666667]}},{"z":[[2.03],[1.85],[2.05],[2.31],[1.5],[2.72]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Max<br>Value: 2.03"],["Row: Patient 4<br>Column: Max<br>Value: 1.85"],["Row: Patient 5<br>Column: Max<br>Value: 2.05"],["Row: Patient 6<br>Column: Max<br>Value: 2.31"],["Row: Patient 1<br>Column: Max<br>Value: 1.5"],["Row: Patient 3<br>Column: Max<br>Value: 2.72"]],"colorscale":[[0,"#F7FCFD"],[0.286885245901639,"#BDE6DD"],[0.434426229508196,"#81CEB7"],[0.450819672131147,"#7BCBB2"],[0.663934426229508,"#38A367"],[1,"#00441B"]],"xaxis":"x4","yaxis":"y","zmin":1.5,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.3,"y":1,"len":0.3,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7]}},{"z":[[0.08],[0.07],[0.06],[0.09],[0.05],[0.08]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Min<br>Value: 0.08"],["Row: Patient 4<br>Column: Min<br>Value: 0.07"],["Row: Patient 5<br>Column: Min<br>Value: 0.06"],["Row: Patient 6<br>Column: Min<br>Value: 0.09"],["Row: Patient 1<br>Column: Min<br>Value: 0.05"],["Row: Patient 3<br>Column: Min<br>Value: 0.08"]],"colorscale":[[0,"#FFFFCC"],[0.25,"#FED976"],[0.5,"#FD8D3C"],[0.75,"#E31A1C"],[1,"#800026"]],"xaxis":"x5","yaxis":"y","zmin":0.05,"zmax":0.09,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.3,"y":0.5,"len":0.3,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.05,0.09]}},{"z":[[1],[1],[2],[1],[1],[2]],"y":[1,2,3,4,5,6],"x":[1],"type":"heatmap","text":[["Row: Patient 2<br>Column: Groups<br>Value: A"],["Row: Patient 4<br>Column: Groups<br>Value: A"],["Row: Patient 5<br>Column: Groups<br>Value: B"],["Row: Patient 6<br>Column: Groups<br>Value: A"],["Row: Patient 1<br>Column: Groups<br>Value: A"],["Row: Patient 3<br>Column: Groups<br>Value: B"]],"colorscale":[[0,"#A6CEE3"],[0.5,"#A6CEE3"],[0.5,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x6","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.5,"y":1,"len":0.3,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09],[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"],["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"]],"colorscale":[[0,"#FFF7FB"],[0.00374531835205992,"#FEF7FB"],[0.00749063670411985,"#FEF6FA"],[0.0112359550561798,"#FDF6FA"],[0.0149812734082397,"#FDF5FA"],[0.0187265917602996,"#FCF5FA"],[0.0224719101123595,"#FCF4F9"],[0.0262172284644195,"#FBF4F9"],[0.0299625468164794,"#FAF3F9"],[0.0411985018726592,"#F9F2F8"],[0.0449438202247191,"#F8F1F8"],[0.0524344569288389,"#F7F0F7"],[0.0561797752808989,"#F6F0F7"],[0.0636704119850187,"#F5EFF6"],[0.0674157303370786,"#F5EEF6"],[0.0711610486891386,"#F4EEF6"],[0.0749063670411985,"#F4EDF6"],[0.0936329588014981,"#F1EBF4"],[0.101123595505618,"#F0EAF4"],[0.116104868913858,"#EDE8F3"],[0.119850187265918,"#EDE8F2"],[0.127340823970037,"#EBE7F2"],[0.131086142322097,"#EBE6F1"],[0.138576779026217,"#E9E5F1"],[0.161048689138577,"#E4E1EF"],[0.202247191011236,"#DBD9EB"],[0.220973782771536,"#D6D6E9"],[0.243445692883895,"#D1D2E7"],[0.247191011235955,"#D1D1E6"],[0.273408239700374,"#C8CDE4"],[0.280898876404494,"#C6CCE3"],[0.284644194756554,"#C5CBE3"],[0.295880149812734,"#C1CAE2"],[0.314606741573034,"#BBC7E0"],[0.333333333333333,"#B4C4DF"],[0.363295880149813,"#AABFDC"],[0.367041198501873,"#A9BEDC"],[0.370786516853933,"#A7BEDB"],[0.415730337078652,"#96B6D7"],[0.50187265917603,"#73A9CF"],[0.52059925093633,"#6BA5CD"],[0.539325842696629,"#63A1CA"],[0.543071161048689,"#62A0CA"],[0.591760299625468,"#4A97C4"],[0.674157303370786,"#2983BA"],[0.741573033707865,"#0C72B1"],[0.749063670411985,"#0670B0"],[0.846441947565543,"#045F95"],[1,"#023858"]],"xaxis":"x7","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.5,"y":0.5,"len":0.3,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x7","yaxis":"y5","showlegend":false,"type":"scatter"}],"layout":{"xaxis3":{"domain":[0.0407407407407406,0.0962962962962962],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis2":{"domain":[0.0981481481481481,0.116666666666667],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.118518518518518,0.488888888888889],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis4":{"domain":[0.494444444444444,0.512962962962963],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.515740740740741,0.534259259259259],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis6":{"domain":[0.537037037037037,0.555555555555556],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[1],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis7":{"domain":[0.62962962962963,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis8":{"domain":[0,0.037037037037037],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.0769230769230768,0.776223776223776],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77972027972028,0.884615384615385],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis3":{"domain":[0,0.0699300699300698],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis4":{"domain":[0,0.0699300699300698],"anchor":"x7","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis5":{"domain":[0.79020979020979,1],"anchor":"x7"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.054501156730228,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.0586007929957255,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.018788751846197,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.0146875002644584,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.07945134058047,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.07945134058047,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0586007929957255,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.0586007929957255,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"annotations":[{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"},{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x7","yref":"y4"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x8","yref":"y"}],"legend":{"x":1.9,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="continuous-axes" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#continuous-axes" class="anchor"> </a></body></html>Continuous Axes</h2>
<p>In all the plots above, the axes of the main heatmaps have been treated as categorical, with the columns of equal widths and rows of equal widths. In some cases, it may make sense to treat one or both axes as continuous. There are several ways to indicate to iheatmapr that the axes should be continuous. The first is to use the <code>x_categorical</code> and <code>y_categorical</code> arguments, setting them to false.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix, <span class="dt">x_categorical =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="htmlwidget-ed80ef705979f74c4adc" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed80ef705979f74c4adc">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.125,9]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>By default, names of rows and columns are taken from the row and column names of the matrix, respectively. Alternatively, these can be provided to the x and y arguments to <code>main_heatmap</code> or <code>iheatmap</code>. If the values are given as numeric and do not correspond simply to the row or column number, then the axis is assumed to be continuous.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix, <span class="dt">x =</span> <span class="kw">as.numeric</span>(<span class="kw">colnames</span>(Indometh_matrix)))</code></pre></div>
<div id="htmlwidget-31cf5d40db21ca5bf61e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-31cf5d40db21ca5bf61e">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.125,9]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div id="labels" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#labels" class="anchor"> </a></body></html>Labels</h3>
<p>Labels will be a bit different for continuous axes – rather than labelling every row or column, labels are chosen more similarly to a regular plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix, <span class="dt">x_categorical =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_labels.html">add_col_labels</a></span>()</code></pre></div>
<div id="htmlwidget-7586d6080bca3311dd13" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7586d6080bca3311dd13">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.125,9]},"yaxis":{"domain":[0.0950226244343891,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0,0.0904977375565611],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"1","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"2","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"3","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"4","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"5","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"6","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"7","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"8","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="clustering" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#clustering" class="anchor"> </a></body></html>Clustering</h3>
<p>Another major difference with categorical axes is that continuous axes can’t be clustered!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix, <span class="dt">x_categorical =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_clustering.html">add_col_clustering</a></span>() <span class="co"># will give error</span></code></pre></div>
<pre><code>## Error in .local(p, ...): Cannot cluster continuous axis!</code></pre>
</div>
</div>
<div id="orientation" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#orientation" class="anchor"> </a></body></html>Orientation</h2>
<p>By default, additional heatmaps are added horizontally to left or right of existing heatmap(s). It is also possible to build up complex heatmaps vertically rather than horizontally by setting <code>orientation = vertical</code> to the initial call to <code>iheatmap</code> or <code>main_heatmap</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/iheatmap.html">iheatmap</a></span>(Indometh_patient_cor, 
         <span class="dt">cluster_cols =</span> <span class="st">"hclust"</span>, 
         <span class="dt">cluster_rows =</span> <span class="st">"hclust"</span>,
         <span class="dt">row_title =</span> <span class="st">"Patients"</span>,
         <span class="dt">name =</span> <span class="st">"Correlation"</span>,
         <span class="dt">orientation =</span> <span class="st">"vertical"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_iheatmap.html">add_iheatmap</a></span>(<span class="kw">t</span>(Indometh_matrix),
               <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span>
               <span class="dt">row_title =</span> <span class="st">"Time"</span>,
         <span class="dt">col_title =</span> <span class="st">"Patients"</span>) </code></pre></div>
<div id="htmlwidget-6ef992c13ea02b712a1e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6ef992c13ea02b712a1e">{"x":{"data":[{"z":[[1,0.965773901965006,0.951013130877337,0.976554671712002,0.964571333758498,0.965923796718617],[0.965773901965006,1,0.945569345888539,0.988184065237917,0.984112317478279,0.974912505080182],[0.951013130877337,0.945569345888539,1,0.980573870131569,0.984220839243537,0.985463149439562],[0.976554671712002,0.988184065237917,0.980573870131569,1,0.994383146538843,0.995838446707506],[0.964571333758498,0.984112317478279,0.984220839243537,0.994383146538843,1,0.992075489712426],[0.965923796718617,0.974912505080182,0.985463149439562,0.995838446707506,0.992075489712426,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Column: Patient 2<br>Value: 1","Row: Patient 2<br>Column: Patient 4<br>Value: 0.965773901965006","Row: Patient 2<br>Column: Patient 5<br>Value: 0.951013130877337","Row: Patient 2<br>Column: Patient 6<br>Value: 0.976554671712002","Row: Patient 2<br>Column: Patient 1<br>Value: 0.964571333758498","Row: Patient 2<br>Column: Patient 3<br>Value: 0.965923796718617"],["Row: Patient 4<br>Column: Patient 2<br>Value: 0.965773901965006","Row: Patient 4<br>Column: Patient 4<br>Value: 1","Row: Patient 4<br>Column: Patient 5<br>Value: 0.945569345888539","Row: Patient 4<br>Column: Patient 6<br>Value: 0.988184065237917","Row: Patient 4<br>Column: Patient 1<br>Value: 0.984112317478279","Row: Patient 4<br>Column: Patient 3<br>Value: 0.974912505080182"],["Row: Patient 5<br>Column: Patient 2<br>Value: 0.951013130877337","Row: Patient 5<br>Column: Patient 4<br>Value: 0.945569345888539","Row: Patient 5<br>Column: Patient 5<br>Value: 1","Row: Patient 5<br>Column: Patient 6<br>Value: 0.980573870131569","Row: Patient 5<br>Column: Patient 1<br>Value: 0.984220839243537","Row: Patient 5<br>Column: Patient 3<br>Value: 0.985463149439562"],["Row: Patient 6<br>Column: Patient 2<br>Value: 0.976554671712002","Row: Patient 6<br>Column: Patient 4<br>Value: 0.988184065237917","Row: Patient 6<br>Column: Patient 5<br>Value: 0.980573870131569","Row: Patient 6<br>Column: Patient 6<br>Value: 1","Row: Patient 6<br>Column: Patient 1<br>Value: 0.994383146538843","Row: Patient 6<br>Column: Patient 3<br>Value: 0.995838446707506"],["Row: Patient 1<br>Column: Patient 2<br>Value: 0.964571333758498","Row: Patient 1<br>Column: Patient 4<br>Value: 0.984112317478279","Row: Patient 1<br>Column: Patient 5<br>Value: 0.984220839243537","Row: Patient 1<br>Column: Patient 6<br>Value: 0.994383146538843","Row: Patient 1<br>Column: Patient 1<br>Value: 1","Row: Patient 1<br>Column: Patient 3<br>Value: 0.992075489712426"],["Row: Patient 3<br>Column: Patient 2<br>Value: 0.965923796718617","Row: Patient 3<br>Column: Patient 4<br>Value: 0.974912505080182","Row: Patient 3<br>Column: Patient 5<br>Value: 0.985463149439562","Row: Patient 3<br>Column: Patient 6<br>Value: 0.995838446707506","Row: Patient 3<br>Column: Patient 1<br>Value: 0.992075489712426","Row: Patient 3<br>Column: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.100013220080906,"#FEE5E1"],[0.349104529059078,"#FBA7B7"],[0.371198112649773,"#FAA0B5"],[0.373951979125523,"#FA9FB5"],[0.539092532886991,"#EF599E"],[0.569262418930555,"#E94D9C"],[0.64310313396838,"#D62F93"],[0.708111490095512,"#BE1886"],[0.710105252012013,"#BD1786"],[0.732928975450674,"#B40C81"],[0.782917641631007,"#A0017C"],[0.854410893697019,"#830178"],[0.896807165872843,"#720075"],[0.923543941177481,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.945569345888539,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.946,1]}},{"z":[[2.03,1.85,2.05,2.31,1.5,2.72],[1.63,1.39,1.04,1.44,0.94,1.49],[0.71,1.02,0.81,1.03,0.78,1.16],[0.7,0.89,0.39,0.84,0.48,0.8],[0.64,0.59,0.3,0.64,0.37,0.8],[0.36,0.4,0.23,0.42,0.19,0.39],[0.32,0.16,0.13,0.24,0.12,0.22],[0.2,0.11,0.11,0.17,0.11,0.12],[0.25,0.1,0.08,0.13,0.08,0.11],[0.12,0.07,0.1,0.1,0.07,0.08],[0.08,0.07,0.06,0.09,0.05,0.08]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6,7,8,9,10,11],"type":"heatmap","text":[["Row: 0.25<br>Column: Patient 2<br>Value: 2.03","Row: 0.25<br>Column: Patient 4<br>Value: 1.85","Row: 0.25<br>Column: Patient 5<br>Value: 2.05","Row: 0.25<br>Column: Patient 6<br>Value: 2.31","Row: 0.25<br>Column: Patient 1<br>Value: 1.5","Row: 0.25<br>Column: Patient 3<br>Value: 2.72"],["Row: 0.5<br>Column: Patient 2<br>Value: 1.63","Row: 0.5<br>Column: Patient 4<br>Value: 1.39","Row: 0.5<br>Column: Patient 5<br>Value: 1.04","Row: 0.5<br>Column: Patient 6<br>Value: 1.44","Row: 0.5<br>Column: Patient 1<br>Value: 0.94","Row: 0.5<br>Column: Patient 3<br>Value: 1.49"],["Row: 0.75<br>Column: Patient 2<br>Value: 0.71","Row: 0.75<br>Column: Patient 4<br>Value: 1.02","Row: 0.75<br>Column: Patient 5<br>Value: 0.81","Row: 0.75<br>Column: Patient 6<br>Value: 1.03","Row: 0.75<br>Column: Patient 1<br>Value: 0.78","Row: 0.75<br>Column: Patient 3<br>Value: 1.16"],["Row: 1<br>Column: Patient 2<br>Value: 0.7","Row: 1<br>Column: Patient 4<br>Value: 0.89","Row: 1<br>Column: Patient 5<br>Value: 0.39","Row: 1<br>Column: Patient 6<br>Value: 0.84","Row: 1<br>Column: Patient 1<br>Value: 0.48","Row: 1<br>Column: Patient 3<br>Value: 0.8"],["Row: 1.25<br>Column: Patient 2<br>Value: 0.64","Row: 1.25<br>Column: Patient 4<br>Value: 0.59","Row: 1.25<br>Column: Patient 5<br>Value: 0.3","Row: 1.25<br>Column: Patient 6<br>Value: 0.64","Row: 1.25<br>Column: Patient 1<br>Value: 0.37","Row: 1.25<br>Column: Patient 3<br>Value: 0.8"],["Row: 2<br>Column: Patient 2<br>Value: 0.36","Row: 2<br>Column: Patient 4<br>Value: 0.4","Row: 2<br>Column: Patient 5<br>Value: 0.23","Row: 2<br>Column: Patient 6<br>Value: 0.42","Row: 2<br>Column: Patient 1<br>Value: 0.19","Row: 2<br>Column: Patient 3<br>Value: 0.39"],["Row: 3<br>Column: Patient 2<br>Value: 0.32","Row: 3<br>Column: Patient 4<br>Value: 0.16","Row: 3<br>Column: Patient 5<br>Value: 0.13","Row: 3<br>Column: Patient 6<br>Value: 0.24","Row: 3<br>Column: Patient 1<br>Value: 0.12","Row: 3<br>Column: Patient 3<br>Value: 0.22"],["Row: 4<br>Column: Patient 2<br>Value: 0.2","Row: 4<br>Column: Patient 4<br>Value: 0.11","Row: 4<br>Column: Patient 5<br>Value: 0.11","Row: 4<br>Column: Patient 6<br>Value: 0.17","Row: 4<br>Column: Patient 1<br>Value: 0.11","Row: 4<br>Column: Patient 3<br>Value: 0.12"],["Row: 5<br>Column: Patient 2<br>Value: 0.25","Row: 5<br>Column: Patient 4<br>Value: 0.1","Row: 5<br>Column: Patient 5<br>Value: 0.08","Row: 5<br>Column: Patient 6<br>Value: 0.13","Row: 5<br>Column: Patient 1<br>Value: 0.08","Row: 5<br>Column: Patient 3<br>Value: 0.11"],["Row: 6<br>Column: Patient 2<br>Value: 0.12","Row: 6<br>Column: Patient 4<br>Value: 0.07","Row: 6<br>Column: Patient 5<br>Value: 0.1","Row: 6<br>Column: Patient 6<br>Value: 0.1","Row: 6<br>Column: Patient 1<br>Value: 0.07","Row: 6<br>Column: Patient 3<br>Value: 0.08"],["Row: 8<br>Column: Patient 2<br>Value: 0.08","Row: 8<br>Column: Patient 4<br>Value: 0.07","Row: 8<br>Column: Patient 5<br>Value: 0.06","Row: 8<br>Column: Patient 6<br>Value: 0.09","Row: 8<br>Column: Patient 1<br>Value: 0.05","Row: 8<br>Column: Patient 3<br>Value: 0.08"]],"colorscale":[[0,"#F7FCFD"],[0.00374531835205992,"#F6FCFD"],[0.00749063670411985,"#F6FCFD"],[0.0112359550561798,"#F5FBFD"],[0.0149812734082397,"#F5FBFD"],[0.0187265917602996,"#F4FBFC"],[0.0224719101123595,"#F4FBFC"],[0.0262172284644195,"#F3FBFC"],[0.0299625468164794,"#F3FAFC"],[0.0411985018726592,"#F1FAFC"],[0.0449438202247191,"#F1F9FC"],[0.0524344569288389,"#EFF9FB"],[0.0561797752808989,"#EFF9FB"],[0.0636704119850187,"#EEF8FB"],[0.0674157303370786,"#EDF8FB"],[0.0711610486891386,"#EDF8FB"],[0.0749063670411985,"#ECF8FB"],[0.0936329588014981,"#EAF7FA"],[0.101123595505618,"#E8F6FA"],[0.116104868913858,"#E6F5F9"],[0.119850187265918,"#E6F5F9"],[0.127340823970037,"#E5F5F9"],[0.131086142322097,"#E4F5F8"],[0.138576779026217,"#E2F4F7"],[0.161048689138577,"#DEF2F3"],[0.202247191011236,"#D6EFED"],[0.220973782771536,"#D2EEEA"],[0.243445692883895,"#CDECE7"],[0.247191011235955,"#CDECE6"],[0.273408239700374,"#C3E8E1"],[0.280898876404494,"#C0E7DF"],[0.284644194756554,"#BEE6DE"],[0.295880149812734,"#BAE5DB"],[0.314606741573034,"#B2E2D7"],[0.333333333333333,"#AADFD3"],[0.363295880149813,"#9EDACC"],[0.367041198501873,"#9CD9CB"],[0.370786516853933,"#9BD9CA"],[0.415730337078652,"#89D1BD"],[0.50187265917603,"#65C2A3"],[0.52059925093633,"#60BF9C"],[0.539325842696629,"#5BBC95"],[0.543071161048689,"#5ABB94"],[0.591760299625468,"#4CB382"],[0.674157303370786,"#36A063"],[0.741573033707865,"#258D48"],[0.749063670411985,"#238B45"],[0.846441947565543,"#0A7432"],[1,"#00441B"]],"xaxis":"x","yaxis":"y3","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.6,"len":0.27,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis":{"domain":[0.209486166007905,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.0869565217391303,0.205533596837944],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis3":{"domain":[0,0.0790513833992093],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis4":{"domain":[0.122529644268774,0.201581027667984],"anchor":"y3","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0.0446247464503042,0.450304259634889],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0.531440162271805,0.93711967545639],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.939148073022312,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis4":{"domain":[0,0.0405679513184584],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.054501156730228,"y0":1.5,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0.054501156730228,"y0":1.5,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.07945134058047,"y0":2.6875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.07945134058047,"x1":-0.0586007929957255,"y0":3.875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.0586007929957255,"y0":3.875,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0586007929957255,"x1":-0.018788751846197,"y0":4.75,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.018788751846197,"y0":4.75,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197,"x1":-0.0146875002644584,"y0":5.5,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0.0146875002644584,"y0":5.5,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0146875002644584,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.07945134058047,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228,"y1":0.054501156730228,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.07945134058047,"y1":0.07945134058047,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.07945134058047,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0586007929957255,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.0586007929957255,"y1":0.0586007929957255,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.0586007929957255,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197,"y1":0.018788751846197,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.0146875002644584,"y1":0.0146875002644584,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.0146875002644584,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"annotations":[{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x3","yref":"y"},{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y4"},{"text":"Time","y":6,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x4","yref":"y3"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="plotly-modifications" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#plotly-modifications" class="anchor"> </a></body></html>Plotly modifications</h2>
<p>When displaying an Iheatmap object, iheatmapr converts the object into a plotly htmlwidget. If you want to be able to inspect or modify that object, the <code>as_plotly</code> function will convert an Iheatmap object to a plotly htmlwidgets object. If you are familiar with the plotly R package, this is the type of object that results from the “plotly_build” command. Note that after such conversion, none of the iheatmap functions can be used anymore. However, the object can be passed to plotly functions, like layout.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/as_plotly.html">as_plotly</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">layout</span>(<span class="dt">margin =</span> <span class="kw">list</span>(<span class="dt">b =</span> <span class="dv">120</span>))</code></pre></div>
<div id="htmlwidget-5ef2e042a81f519f72b5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5ef2e042a81f519f72b5">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":120,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Converting the object to a plotly object also enables use of these heatmaps in shiny, as we can then take advantage of the plotly R packages renderPlotly, plotlyOutput, and event_data functions.</p>
</div>
<div id="axis-properties" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#axis-properties" class="anchor"> </a></body></html>Axis properties</h2>
<p>Most functions for adding a subplot include a “layout” argument for providing layout parameters for the additional axis that is created. This layout parameter accepts a list of layout parameters that plotly uses for altering the layout of an axis. See the <a href="https://plot.ly/javascript/reference/#layout-xaxis">plotly documentation</a> for more information about the various options.</p>
<p>As an example, here is a plot with default axis options:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/iheatmap.html">iheatmap</a></span>(Indometh_matrix,
               <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span>
               <span class="dt">col_title =</span> <span class="st">"Time"</span>,
         <span class="dt">row_title =</span> <span class="st">"Patients"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>()</code></pre></div>
<div id="htmlwidget-e31aa1d75d9f75298324" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e31aa1d75d9f75298324">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y3","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0.0990990990990992,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.0900900900900901],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.076923076923077,0.776223776223776],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0,0.06993006993007],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0.79020979020979,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y2"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x2","yref":"y"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Adding <code>zeroline = FALSE</code> removes the zero line, and <code>title = "Average"</code> adds yaxis label.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/iheatmap.html">iheatmap</a></span>(Indometh_matrix,
               <span class="dt">name =</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span>
               <span class="dt">col_title =</span> <span class="st">"Time"</span>,
         <span class="dt">row_title =</span> <span class="st">"Patients"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>(<span class="dt">layout =</span> <span class="kw">list</span>(<span class="dt">zeroline =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">"Average"</span>))</code></pre></div>
<div id="htmlwidget-a62782158009d2493f65" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a62782158009d2493f65">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y3","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0.0990990990990992,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.0900900900900901],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.076923076923077,0.776223776223776],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0,0.06993006993007],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0.79020979020979,1],"anchor":"x","zeroline":false,"title":"Average"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y2"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x2","yref":"y"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="sharing-axes" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#sharing-axes" class="anchor"> </a></body></html>Sharing axes</h2>
<p>By default subplots stacked vertically share the X axis with a main heatmap, and subplots stacked horizontally share their Y axis with a main heatmap. Subplots can also be made to share the other axis with an existing subplot.</p>
<p>Here is an example of two subplots with independent axes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_main_heatmap.html">add_main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>()</code></pre></div>
<div id="htmlwidget-a1f257a0d325f7163da3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a1f257a0d325f7163da3">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"},{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x2","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x2","yaxis":"y3","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,0.490196078431373],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0.509803921568627,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.757575757575758],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.772727272727273,1],"anchor":"x"},"yaxis3":{"domain":[0.772727272727273,1],"anchor":"x2"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>By passing the same “yname” argument to both axes, the axes become shared:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>(<span class="dt">yname =</span> <span class="st">"Summary"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_main_heatmap.html">add_main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>(<span class="dt">yname =</span> <span class="st">"Summary"</span>)</code></pre></div>
<div id="htmlwidget-8040faa817a1e0ee6b7e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8040faa817a1e0ee6b7e">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"},{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x2","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x2","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,0.490196078431373],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0.509803921568627,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.757575757575758],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.772727272727273,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="altering-plot-sizes-and-spacing" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#altering-plot-sizes-and-spacing" class="anchor"> </a></body></html>Altering plot sizes and spacing</h2>
<p>Each type of subplot has a default relative size and default relative spacing from the previous plots, but both the size and spacing can be altered by passing a ‘buffer’ or ‘size’ argument. Both arguments are relative to the size of the first main heatmap along that dimension.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>()</code></pre></div>
<div id="htmlwidget-5a3ff55c32b92b39d858" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5a3ff55c32b92b39d858">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.757575757575758],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.772727272727273,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/main_heatmap.html">main_heatmap</a></span>(Indometh_matrix) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/add_col_summary.html">add_col_summary</a></span>(<span class="dt">buffer =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">1</span>)</code></pre></div>
<div id="htmlwidget-11061e03bcecfb67457d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-11061e03bcecfb67457d">{"x":{"data":[{"z":[[1.5,0.94,0.78,0.48,0.37,0.19,0.12,0.11,0.08,0.07,0.05],[2.03,1.63,0.71,0.7,0.64,0.36,0.32,0.2,0.25,0.12,0.08],[2.72,1.49,1.16,0.8,0.8,0.39,0.22,0.12,0.11,0.08,0.08],[1.85,1.39,1.02,0.89,0.59,0.4,0.16,0.11,0.1,0.07,0.07],[2.05,1.04,0.81,0.39,0.3,0.23,0.13,0.11,0.08,0.1,0.06],[2.31,1.44,1.03,0.84,0.64,0.42,0.24,0.17,0.13,0.1,0.09]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Column: 0.25<br>Value: 1.5","Row: Patient 1<br>Column: 0.5<br>Value: 0.94","Row: Patient 1<br>Column: 0.75<br>Value: 0.78","Row: Patient 1<br>Column: 1<br>Value: 0.48","Row: Patient 1<br>Column: 1.25<br>Value: 0.37","Row: Patient 1<br>Column: 2<br>Value: 0.19","Row: Patient 1<br>Column: 3<br>Value: 0.12","Row: Patient 1<br>Column: 4<br>Value: 0.11","Row: Patient 1<br>Column: 5<br>Value: 0.08","Row: Patient 1<br>Column: 6<br>Value: 0.07","Row: Patient 1<br>Column: 8<br>Value: 0.05"],["Row: Patient 2<br>Column: 0.25<br>Value: 2.03","Row: Patient 2<br>Column: 0.5<br>Value: 1.63","Row: Patient 2<br>Column: 0.75<br>Value: 0.71","Row: Patient 2<br>Column: 1<br>Value: 0.7","Row: Patient 2<br>Column: 1.25<br>Value: 0.64","Row: Patient 2<br>Column: 2<br>Value: 0.36","Row: Patient 2<br>Column: 3<br>Value: 0.32","Row: Patient 2<br>Column: 4<br>Value: 0.2","Row: Patient 2<br>Column: 5<br>Value: 0.25","Row: Patient 2<br>Column: 6<br>Value: 0.12","Row: Patient 2<br>Column: 8<br>Value: 0.08"],["Row: Patient 3<br>Column: 0.25<br>Value: 2.72","Row: Patient 3<br>Column: 0.5<br>Value: 1.49","Row: Patient 3<br>Column: 0.75<br>Value: 1.16","Row: Patient 3<br>Column: 1<br>Value: 0.8","Row: Patient 3<br>Column: 1.25<br>Value: 0.8","Row: Patient 3<br>Column: 2<br>Value: 0.39","Row: Patient 3<br>Column: 3<br>Value: 0.22","Row: Patient 3<br>Column: 4<br>Value: 0.12","Row: Patient 3<br>Column: 5<br>Value: 0.11","Row: Patient 3<br>Column: 6<br>Value: 0.08","Row: Patient 3<br>Column: 8<br>Value: 0.08"],["Row: Patient 4<br>Column: 0.25<br>Value: 1.85","Row: Patient 4<br>Column: 0.5<br>Value: 1.39","Row: Patient 4<br>Column: 0.75<br>Value: 1.02","Row: Patient 4<br>Column: 1<br>Value: 0.89","Row: Patient 4<br>Column: 1.25<br>Value: 0.59","Row: Patient 4<br>Column: 2<br>Value: 0.4","Row: Patient 4<br>Column: 3<br>Value: 0.16","Row: Patient 4<br>Column: 4<br>Value: 0.11","Row: Patient 4<br>Column: 5<br>Value: 0.1","Row: Patient 4<br>Column: 6<br>Value: 0.07","Row: Patient 4<br>Column: 8<br>Value: 0.07"],["Row: Patient 5<br>Column: 0.25<br>Value: 2.05","Row: Patient 5<br>Column: 0.5<br>Value: 1.04","Row: Patient 5<br>Column: 0.75<br>Value: 0.81","Row: Patient 5<br>Column: 1<br>Value: 0.39","Row: Patient 5<br>Column: 1.25<br>Value: 0.3","Row: Patient 5<br>Column: 2<br>Value: 0.23","Row: Patient 5<br>Column: 3<br>Value: 0.13","Row: Patient 5<br>Column: 4<br>Value: 0.11","Row: Patient 5<br>Column: 5<br>Value: 0.08","Row: Patient 5<br>Column: 6<br>Value: 0.1","Row: Patient 5<br>Column: 8<br>Value: 0.06"],["Row: Patient 6<br>Column: 0.25<br>Value: 2.31","Row: Patient 6<br>Column: 0.5<br>Value: 1.44","Row: Patient 6<br>Column: 0.75<br>Value: 1.03","Row: Patient 6<br>Column: 1<br>Value: 0.84","Row: Patient 6<br>Column: 1.25<br>Value: 0.64","Row: Patient 6<br>Column: 2<br>Value: 0.42","Row: Patient 6<br>Column: 3<br>Value: 0.24","Row: Patient 6<br>Column: 4<br>Value: 0.17","Row: Patient 6<br>Column: 5<br>Value: 0.13","Row: Patient 6<br>Column: 6<br>Value: 0.1","Row: Patient 6<br>Column: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.00374531835205992,"#FFF6F2"],[0.00749063670411985,"#FFF6F2"],[0.0112359550561798,"#FFF5F1"],[0.0149812734082397,"#FFF4F0"],[0.0187265917602996,"#FFF4F0"],[0.0224719101123595,"#FFF3EF"],[0.0262172284644195,"#FFF2EE"],[0.0299625468164794,"#FFF1EE"],[0.0411985018726592,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.0524344569288389,"#FEEDEA"],[0.0561797752808989,"#FEEDE9"],[0.0636704119850187,"#FEEBE8"],[0.0674157303370786,"#FEEBE7"],[0.0711610486891386,"#FEEAE6"],[0.0749063670411985,"#FEE9E6"],[0.0936329588014981,"#FEE6E2"],[0.101123595505618,"#FDE4E1"],[0.116104868913858,"#FDE2DF"],[0.119850187265918,"#FDE1DE"],[0.127340823970037,"#FDDFDC"],[0.131086142322097,"#FDDFDC"],[0.138576779026217,"#FDDDDA"],[0.161048689138577,"#FDD8D5"],[0.202247191011236,"#FDCFCB"],[0.220973782771536,"#FCCBC7"],[0.243445692883895,"#FCC6C2"],[0.247191011235955,"#FCC6C1"],[0.273408239700374,"#FCBEBE"],[0.280898876404494,"#FCBCBD"],[0.284644194756554,"#FCBBBD"],[0.295880149812734,"#FCB7BC"],[0.314606741573034,"#FBB2BA"],[0.333333333333333,"#FBACB9"],[0.363295880149813,"#FAA3B6"],[0.367041198501873,"#FAA1B6"],[0.370786516853933,"#FAA0B5"],[0.415730337078652,"#F98EAE"],[0.50187265917603,"#F767A1"],[0.52059925093633,"#F3609F"],[0.539325842696629,"#EF599E"],[0.543071161048689,"#EE589E"],[0.591760299625468,"#E4449A"],[0.674157303370786,"#CA258D"],[0.741573033707865,"#B10680"],[0.749063670411985,"#AE027E"],[0.846441947565543,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.05,"zmax":2.72,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.9,"len":0.27,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.1,2.7]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.07666666666667,1.32166666666667,0.918333333333333,0.683333333333333,0.556666666666667,0.331666666666667,0.198333333333333,0.136666666666667,0.125,0.09,0.0716666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.454545454545455],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.545454545454545,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"Iheatmap","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]},"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="sizing-in-knitr" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#sizing-in-knitr" class="anchor"> </a></body></html>Sizing in knitr</h2>
<p>To change the sizing within knitr, use the fig.width and fig.height chunk options.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#session-info" class="anchor"> </a></body></html>Session Info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.3.3 (2017-03-06)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X El Capitan 10.11.5
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] reshape2_1.4.2  purrr_0.2.2     iheatmapr_0.2.3 plotly_4.5.6   
## [5] ggplot2_2.2.1  
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.9          RColorBrewer_1.1-2   plyr_1.8.4          
##  [4] base64enc_0.1-3      tools_3.3.3          highlight_0.4.7     
##  [7] testthat_1.0.2.9000  pkgbuild_0.0.0.9000  pkgload_0.0.0.9000  
## [10] digest_0.6.12        memoise_1.0.0        evaluate_0.10       
## [13] jsonlite_1.3         tibble_1.2           gtable_0.2.0        
## [16] viridisLite_0.1.3    DBI_0.6              commonmark_1.2      
## [19] yaml_2.1.14          parallel_3.3.3       pkgdown_0.1.0.9000  
## [22] ggdendro_0.1-20      withr_1.0.2          dplyr_0.5.0         
## [25] httr_1.2.1           stringr_1.2.0        knitr_1.15.1        
## [28] roxygen2_6.0.1       xml2_1.1.1           devtools_1.12.0.9000
## [31] desc_1.1.0           S4Vectors_0.10.3     htmlwidgets_0.8     
## [34] stats4_3.3.3         rprojroot_1.2        grid_3.3.3          
## [37] R6_2.2.0             rmarkdown_1.3.9004   fastcluster_1.1.22  
## [40] whisker_0.3-2        tidyr_0.6.1          magrittr_1.5        
## [43] MASS_7.3-45          scales_0.4.1         backports_1.0.5     
## [46] htmltools_0.3.5      BiocGenerics_0.18.0  assertthat_0.1      
## [49] colorspace_1.3-2     stringi_1.1.2        lazyeval_0.2.0      
## [52] munsell_0.4.3        crayon_1.3.2</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-complex-heatmap">Example Complex Heatmap</a></li>
      <li><a href="#modular-system-for-building-up-complex-heatmaps">Modular system for building up complex heatmaps</a></li>
      <li><a href="#the-iheatmap-and-add_iheatmap-functions">The iheatmap and add_iheatmap functions</a></li>
      <li><a href="#saving-plots">Saving plots</a></li>
      </ul>
</li>
      <li>
<a href="#modular-building-blocks">Modular building blocks</a><ul class="nav nav-pills nav-stacked">
<li><a href="#main-heatmap">Main heatmap</a></li>
      <li><a href="#add-main-heatmap">Add main heatmap</a></li>
      <li><a href="#add-labels">Add labels</a></li>
      <li><a href="#add-clustering">Add clustering</a></li>
      <li><a href="#add-annotations">Add annotations</a></li>
      <li><a href="#add-summary">Add summary</a></li>
      <li><a href="#add-barplot">Add barplot</a></li>
      <li><a href="#add-line-plot">Add line plot</a></li>
      <li><a href="#add-arbitrary-plot">Add arbitrary plot</a></li>
      </ul>
</li>
      <li>
<a href="#customization-options">Customization options</a><ul class="nav nav-pills nav-stacked">
<li><a href="#color-selection">Color selection</a></li>
      <li><a href="#colorbars">Colorbars</a></li>
      <li><a href="#continuous-axes">Continuous Axes</a></li>
      <li><a href="#orientation">Orientation</a></li>
      <li><a href="#plotly-modifications">Plotly modifications</a></li>
      <li><a href="#axis-properties">Axis properties</a></li>
      <li><a href="#sharing-axes">Sharing axes</a></li>
      <li><a href="#altering-plot-sizes-and-spacing">Altering plot sizes and spacing</a></li>
      <li><a href="#sizing-in-knitr">Sizing in knitr</a></li>
      </ul>
</li>
      <li><a href="#session-info">Session Info</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alicia Schep, Sarah Kummerfeld.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
